/*
 * This Scala source file was generated by the Gradle "init" task.
 */
package tbench.tpcds.action

import org.apache.spark.sql.DataFrame
import org.junit.jupiter.api.Test
import tpcds.action.TPCDSTableAction

import scala.reflect.runtime.universe._


class TPCDSActionTest {

    @Test
    def testCreateMeta(): Unit = {
        val a1 = new TPCDSTableTestAction
//        a1.createTPCDSMeta

        val u = a1.getUserName
        println(u)
    }

    @Test
    def testCreateDatabase(): Unit = {
        val a1 = new TPCDSTableTestAction
        a1.createDatabase(1, "orc", "")
        println("\n" * 3)
        a1.createDatabase(1, "parquet", "hive")
        println("\n" * 3)
        a1.createDatabase(1, "iceberg", "")
        println("\n" * 3)
        a1.createDatabase(1, "hudi", "")
    }

    @Test
    def testCreatePartitonedDatabase(): Unit = {
        val a1 = new TPCDSTableTestAction
        a1.createDatabase(1, "orc", "", true)
    }

}

class TPCDSTableTestAction extends TPCDSTableAction(null, "meta") {
    private var df: DataFrame = null

    def setReturnDF(df: DataFrame) = {
        this.df = df
    }

    override def setSparkConf(k: String, v: String): Unit = {
        println(s"set $k=$v")
    }

    override def tableCreated(db: String, tb: String): Boolean = false

    override def runDDL(ql: String): Unit = {
        println(ql)
    }

    override def runSQL(ql: String): DataFrame = {
        println(ql)
        df
    }
}


